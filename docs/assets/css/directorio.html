<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Restaurantes Cercanos</title>
<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.container {
  max-width: 800px;
  width: 100%;
}

.hero-image {
  width: 100%;
  margin-bottom: 20px;
}

.hero-image img {
  width: 100%;
  height: auto;
  border-radius: 8px;
}

h1 {
  text-align: center;
  margin-bottom: 20px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 15px;
  justify-items: center;
  margin-top: 50px;
}

.grid a {
  display: block;
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  transition: transform 0.2s ease;
  width: 100%;
  max-width: 220px; 
}

.grid a:hover {
  transform: scale(1.03);
}

.grid img {
  width: 100%;
  aspect-ratio: 1 / 1; 
  object-fit: contain; 
  display: block;
  background-color: #fff;
  padding: 8px; 
}
@media (max-width: 992px) {
 .grid img {
    padding: 0;
  }
}
.ad{
    width: 100%;
}
.ad video{
    width: 100%;
}
</style>
<script src="./instalarapp.js" defer></script>
</head>
<body>

<div class="container">
    <video class="ad" src="https://menutechdeveloper.github.io/bddImg/assets/iconos/wings1.mp4"autoplay muted loop alt="Encabezado"></video>
    <h2>Restaurantes Cercanos</h2>

    <div class="controls">
        <label for="radioBusqueda">Mostrar a:</label>
        <select id="radioBusqueda">
            <option value="5">5 km</option>
            <option value="10" selected>10 km</option>
            <option value="20">20 km</option>
            <option value="50">50 km</option>
            <option value="9999">Todos</option>
        </select>
    </div>

    <div id="restaurantsGrid" class="grid"></div>
</div>

<script>
// ======== ARRAY DE RESTAURANTES ========

const restaurantes = [
    { nombre: "El Herradero", lat: 32.493147555843194, lon: -117.04845390257702, url: "https://menutechdeveloper.github.io/restaurante2/", imagen: "https://menutech.services/assets/img/herradero.png" },
    { nombre: "Alex Tacos", lat: 32.49068611318261, lon: -117.04150161762415, url: "https://vikingantonio.github.io/alextacosapp/", imagen: "https://menutech.services/assets/img/LA%20COCINA%20DE%20TIJUANA%20(38).png" },
    { nombre: "La Salsita Pinchi", lat: 29.62599215208544, lon: -95.28398228466078, url: "https://lasalsitapinchi.com/app", imagen: "https://lasalsitapinchi.com/logo.jpg" },
    { nombre: "La carreta", lat: 32.53166041871072, lon: -117.05082284762946, url: "https://lacarretarest.com/app", imagen: "https://lacarretarest.com/logo.png" }

];



let latUser = null;
let lonUser = null;

function calcularDistancia(lat1, lon1, lat2, lon2) {
    const R = 6371; 
    const dLat = (lat2 - lat1) * Math.PI / 180;
    const dLon = (lon2 - lon1) * Math.PI / 180;
    const a =
        Math.sin(dLat / 2) ** 2 +
        Math.cos(lat1 * Math.PI / 180) *
        Math.cos(lat2 * Math.PI / 180) *
        Math.sin(dLon / 2) ** 2;
    return R * (2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)));
}

function mostrarRestaurantes(radio) {
    const grid = document.getElementById('restaurantsGrid');
    grid.innerHTML = "";

    let lista = restaurantes;

    if (latUser !== null && lonUser !== null && radio < 9999) {
        lista = restaurantes
            .map(r => {
                const distancia = calcularDistancia(latUser, lonUser, r.lat, r.lon);
                return { ...r, distancia };
            })
            .filter(r => r.distancia <= radio)
            .sort((a, b) => a.distancia - b.distancia);
    }

    lista.forEach(r => {
        const link = document.createElement('a');
        link.href = r.url;
        link.innerHTML = `<img src="${r.imagen}" alt="${r.nombre}">`;
        grid.appendChild(link);
    });
}

// Detectar ubicación al cargar la web
if ("geolocation" in navigator) {
    navigator.geolocation.getCurrentPosition(
        (pos) => {
            latUser = pos.coords.latitude;
            lonUser = pos.coords.longitude;
            mostrarRestaurantes(parseInt(document.getElementById('radioBusqueda').value));
        },
        (error) => {
            console.warn("No se pudo obtener ubicación:", error.message);
            mostrarRestaurantes(9999); // Mostrar todos si no da permisos
        }
    );
} else {
    console.warn("Geolocalización no soportada.");
    mostrarRestaurantes(9999);
}

// Evento para cambiar radio sin recargar
document.getElementById('radioBusqueda').addEventListener('change', function() {
    mostrarRestaurantes(parseInt(this.value));
});
</script>

</body>
</html>
